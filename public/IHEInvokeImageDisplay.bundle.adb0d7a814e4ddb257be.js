(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{839:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),i=r(1),s=r.n(i),c=r(52),o=r(877),u=r(14).a.utils.urlUtil;function f(e){var t=e.location,r=u.parse(t.search),n=r.requestType,i=r.studyUID;switch(n){case"STUDY":return a.a.createElement(o.a,{studyInstanceUIDs:i.split(";")});case"STUDYBASE64":return a.a.createElement(o.a,{studyInstanceUIDs:u.paramString.parseParam(i)});case"PATIENT":default:return""}}f.propTypes={location:s.a.shape({search:s.a.string}).isRequired},t.default=Object(c.f)(f)},865:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0);function a(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e}),[e]),t.current}},867:function(e,t,r){var n=r(498);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},877:function(e,t,r){"use strict";var n=r(58),a=r(0),i=r.n(a),s=r(63),c=r(123),o=r(101),u=r(4),f=r(865),l=r(876),d=r(1),p=r.n(d),v=r(196),y=r(13),S=r(103);function I(e,t,r,n,a,i,s){try{var c=e[i](s),o=c.value}catch(e){return void r(e)}c.done?t(o):Promise.resolve(o).then(n,a)}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,a=!1,i=void 0;try{for(var s,c=e[Symbol.iterator]();!(n=(s=c.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var b=s.a.OHIFStudyMetadata,D=s.a.OHIFSeriesMetadata,g=c.a.retrieveStudiesMetadata,w=c.a.deleteStudyMetadataPromise,j=o.a.studyMetadataManager,O=o.a.makeCancelable,U=function(e,t,r){var n=!1;if(Object.keys(r).length>0){var a=r.seriesInstanceUID,i=function(e,t,r){var n=m(e),a=!1,i=n.findIndex(r.bind(void 0,t));if(i>0){var s=n.splice(i,1);n=[].concat(m(s),m(n))}return i>=0&&(a=!0),{promoted:a,data:n}}(t.getDisplaySets(),a,(function(e,t){return t.SeriesInstanceUID===e}));e.displaySets=i.data,n=i.promoted}return n},A=function(e,t){var r=v.c.modules.sopClassHandlerModule,n=e.getData(),a=new D(t,n);e.addSeries(a),e.createAndAddDisplaySetsForSeries(r,a,!1),n.displaySets=e.getDisplaySets(),E(n,e)},E=function(e,t){var r=e.StudyInstanceUID;j.get(r)||j.add(t)},x=function(e,t){t.sortDisplaySets(e.displaySets)};function C(e){var t,r,n=e.server,s=e.studyInstanceUIDs,c=e.seriesInstanceUIDs,o=e.clearViewportSpecificData,d=h(Object(a.useState)(!1),2),p=d[0],D=d[1],C=h(Object(a.useState)([]),2),T=C[0],M=C[1],P=h(Object(a.useState)(!1),2),R=P[0],k=P[1],q=Object(y.K)(),H=Object(a.useContext)(S.a).appConfig,V=(void 0===H?{}:H).filterQueryParam,F=void 0!==V&&V,J=function(e,t,r){(function(e,t,r,n){var a=!1;return n||(x(e,t),a=U(e,t,r)),a})(e,t,r,F)&&o(0),function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e){var n=r.show,a=void 0===n?function(){}:n;a({message:t})}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=t.seriesInstanceUID,a=!0;if(!n)return a;var i=e.series,s=void 0===i?[]:i,c=e.displaySets,o=void 0===c?[]:c,u=r?s[0]:o[0];return u&&u.SeriesInstanceUID===n||(a=!1),a}(e,r,F),"Query parameters were not applied. Using original series list for given study.",q),M([].concat(m(T),[e])),k(!0)},N=function(e,r){if(Array.isArray(e)&&e.length>0){var n=e.map((function(e){var n=new b(e,e.StudyInstanceUID);return function(e,t){var r=v.c.modules.sopClassHandlerModule;e.displaySets||(e.displaySets=t.createDisplaySets(r)),t.setDisplaySets(e.displaySets)}(e,n),E(e,n),t[e.StudyInstanceUID]=O(function(e){var t=e.getData().seriesLoader;if(!t)return Promise.resolve();for(var r=[];t.hasNext();)r.push(t.next().then((function(t){A(e,t)}),(function(e){u.a.error(e)})));return Promise.all(r)}(n)).then((function(t){t&&!t.isCanceled&&J(e,n,r)})).catch((function(e){e&&!e.isCanceled&&(D(!0),u.a.error(e))})),e}));M(n)}},L=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t={},a=c&&c[0],i=[n,s],a&&(t.seriesInstanceUID=a,F&&i.push(t)),r[s]=O(g.apply(void 0,i)).then((function(e){e&&!e.isCanceled&&N(e,t)})).catch((function(e){e&&!e.isCanceled&&(D(!0),u.a.error(e))}))}catch(e){e&&(D(!0),u.a.error(e))}case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){I(i,n,a,s,c,"next",e)}function c(e){I(i,n,a,s,c,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),Q=function(){for(var e in r)"cancel"in r[e]&&r[e].cancel();for(var n in t)"cancel"in t[n]&&(t[n].cancel(),w(n),j.remove(n))},Y=Object(f.a)(s);return Object(a.useEffect)((function(){!(Y&&Y.every((function(e){return s.includes(e)})))&&(j.purge(),Q())}),[s]),Object(a.useEffect)((function(){return t={},r={},L(),function(){Q()}}),[]),p?i.a.createElement("div",null,"Error: ",JSON.stringify(p)):i.a.createElement(l.a,{studies:T,isStudyLoaded:R,studyInstanceUIDs:s})}C.propTypes={studyInstanceUIDs:p.a.array.isRequired,seriesInstanceUIDs:p.a.array,server:p.a.object,clearViewportSpecificData:p.a.func.isRequired};var T=C,M=r(14).a.redux.actions.clearViewportSpecificData,P=function(e){return!0===e.active},R=Object(n.b)((function(e,t){var r=e.servers.servers.find(P);return{server:t.server||r}}),(function(e){return{clearViewportSpecificData:function(){e(M())}}}))(T);t.a=R},878:function(e,t,r){var n=r(867),a=r(198);e.exports=function(e){return null==e?[]:n(e,a(e))}}}]);
//# sourceMappingURL=IHEInvokeImageDisplay.bundle.adb0d7a814e4ddb257be.js.map