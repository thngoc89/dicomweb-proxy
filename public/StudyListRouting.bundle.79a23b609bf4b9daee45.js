(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{843:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(52),u=n(58),s=n(14),l=n(30),f=n(13),p=n(926),d=n(129),y=n(3),m=n.n(y),b=n(950),h=n.n(b);function v(e){if(0===e)return"0 B";var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}function g(e){if(!e)return"Unknown error";if(e.response)try{var t=JSON.parse(e.response);if(t.error&&t.error.code&&t.error.message)return t.error.code+" - "+t.error.message}catch(t){return e.response}return e.message||"Unknown error."}function w(e){if(e.length<=132)return!1;var t=new Uint8Array(e.slice(128,132));return Array.from("DICM").every((function(e,n){return e.charCodeAt(0)===t[n]}))}function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cancelled=!1}var t,n,r;return t=e,(n=[{key:"get",value:function(){return this.cancelled}},{key:"set",value:function(e){this.cancelled=e}}])&&S(t.prototype,n),r&&S(t,r),e}(),j=n(34);function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){E(a,r,o,i,c,"next",e)}function c(e){E(a,r,o,i,c,"throw",e)}i(void 0)}))}}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,o,a;return t=e,(n=[{key:"smartUpload",value:(a=k(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,c,u,s,l,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=1,i=50,0!==(c=Array.from(t)).length){e.next=5;break}throw new Error("No files were provided.");case 5:return u=Math.min(c.length,i),s=!1,l=function(){var e=k(regeneratorRuntime.mark((function e(t,i){var u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=regeneratorRuntime.mark((function e(){var i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.get()){e.next=2;break}return e.abrupt("return",{v:void 0});case 2:if(i=c.slice(0,a),c=c.slice(a),u=null,e.prev=5,!(i.length>1)){e.next=8;break}throw new Error("Not implemented");case 8:if(1!==i.length){e.next=11;break}return e.next=11,f.simpleUpload(i[0],n);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),u=g(e.t0);case 16:if(i.forEach((function(e){return r(e.fileId,u)})),s||0!==c.length){e.next=21;break}return s=!0,t(),e.abrupt("return",{v:void 0});case 21:case"end":return e.stop()}}),e,null,[[5,13]])}));case 1:if(!(c.length>0)){e.next=8;break}return e.delegateYield(u(),"t0",3);case 3:if("object"!==P(l=e.t0)){e.next=6;break}return e.abrupt("return",l.v);case 6:e.next=1;break;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.next=10,new Promise((function(e){for(var t=0;t<u;t++)l(e)}));case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"simpleUpload",value:(o=k(regeneratorRuntime.mark((function e(t,n){var r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getClient(n),e.next=3,this.readFile(t);case 3:if(o=e.sent,w(a=o.content)){e.next=7;break}throw new Error("This is not a valid DICOM file.");case 7:return e.next=9,r.storeInstances({datasets:[a]});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"readFile",value:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t({name:e.name,size:e.size,type:e.type,content:r.result})},r.onerror=function(e){return n(e)},r.readAsArrayBuffer(e)}))}},{key:"setRetrieveAuthHeaderFunction",value:function(e){this.retrieveAuthHeaderFunc=e}},{key:"getClient",value:function(e){var t=this.retrieveAuthHeaderFunc();return new j.a.DICOMwebClient({url:e,headers:t})}}])&&D(t.prototype,n),r&&D(t,r),e}());n(956);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?N(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){function t(){var e,n;_(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return A(N(n=x(this,(e=T(t)).call.apply(e,[this].concat(a)))),"state",{status:"Upload",isCancelled:!1,errorsCount:0,files:null,uploadedVolume:null,wholeVolumeStr:null,isFilesListHidden:!0,timeLeft:null,uploadedList:null,totalCount:0,successfullyUploadedCount:0,lastFile:"",uploadContext:null}),A(N(n),"uploadFiles",(function(e){var t=Array.from(e.target.files),r={};t.forEach((function(e,t){var n={id:t,name:e.name,path:e.webkitRelativePath||e.name,size:e.size,error:null,processed:!1,processedInUI:!1};r[t]=n,e.fileId=t}));var o=t.map((function(e){return e.size})).reduce((function(e,t){return e+t})),a=Math.random();n.setState({status:"Uploading...",files:r,uploadedList:[],uploadedVolume:0,lastFile:t[0].name,totalCount:t.length,wholeVolumeStr:v(o),uploadContext:a,cancellationToken:new O});var i=new O;C.setRetrieveAuthHeaderFunction(n.props.retrieveAuthHeaderFunction),C.smartUpload(e.target.files,n.props.url,(function(e,t){return a===n.state.uploadContext&&n.uploadCallback.call(N(n),e,t)}),i)})),A(N(n),"renderTableRow",(function(e){var t=null;return null!==e.error&&(t=o.a.createElement("p",{style:{color:"red"}},e.error)),o.a.createElement("tr",{key:e.id},o.a.createElement("td",{className:"project"},e.name," ",t))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,e),n=t,(r=[{key:"filesLeft",value:function(){return this.state.uploadedList.length+" of "+this.state.totalCount+" files"}},{key:"volumeLeft",value:function(){return v(this.state.uploadedVolume)+" of "+this.state.wholeVolumeStr}},{key:"percents",value:function(){return parseInt(100*this.state.uploadedList.length/Object.keys(this.state.files).length)}},{key:"isFinished",value:function(){return this.state.isCancelled||Object.keys(this.state.files).length===this.state.uploadedList.length}},{key:"errorsMessage",value:function(){var e=1===this.state.errorsCount?" error":" errors";return this.state.errorsCount+e+" while uploading, click for more info"}},{key:"uploadCallback",value:function(e,t){var n=this.state.files[e];if(n.processed=!0,t)n.error=t,this.setState({errorsCount:this.state.errorsCount+1});else{var r=this.state.uploadedVolume+n.size;this.setState({uploadedVolume:r})}this.setState({lastFile:n.name});var o=this.state.uploadedList;o.push(n),this.setState({uploadedList:o})}},{key:"render",value:function(){return null===this.state.files?o.a.createElement("div",{className:"dicom-uploader"},o.a.createElement("div",{className:"button"},o.a.createElement("label",{htmlFor:"file"},o.a.createElement("img",{src:"./assets/Button_File.svg",alt:"upload file"})),o.a.createElement("input",{className:"invisible-input",onChange:this.uploadFiles,type:"file",id:"file",multiple:!0})),o.a.createElement("div",{className:"button"},o.a.createElement("label",{htmlFor:"folder"},o.a.createElement("img",{src:"./assets/Button_Folder.svg",alt:"upload folder"})),o.a.createElement("input",{className:"invisible-input",type:"file",onChange:this.uploadFiles,id:"folder",webkitdirectory:"true",mozdirectory:"true",multiple:!0}))):o.a.createElement("table",{id:"tblProjectList",className:"table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"table-header"},this.percents(),"% ",this.filesLeft()))),o.a.createElement("tbody",{id:"ProjectList"},this.state.uploadedList.map(this.renderTableRow)))}}])&&R(n.prototype,r),a&&R(n,a),t}(r.Component);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?z(e):t}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}A(L,"propTypes",{id:i.a.string,event:i.a.string,url:i.a.string,retrieveAuthHeaderFunction:i.a.func});var W=function(e){function t(){var e,n;U(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Y(z(n=q(this,(e=H(t)).call.apply(e,[this].concat(o)))),"state",{uploaded:!1}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return this.props.url?o.a.createElement(h.a,{show:this.props.isOpen,onHide:this.props.onClose,"aria-labelledby":"ModalHeader",className:"modal fade themed in",backdrop:!1,size:"md",keyboard:!0},o.a.createElement(h.a.Header,{closeButton:!0},o.a.createElement(h.a.Title,null,this.props.t("Upload DICOM Files"))),o.a.createElement(h.a.Body,null,o.a.createElement(L,{url:this.props.url,retrieveAuthHeaderFunction:this.props.retrieveAuthHeaderFunction}))):null}}])&&B(n.prototype,r),a&&B(n,a),t}(r.Component);Y(W,"propTypes",{url:i.a.string,retrieveAuthHeaderFunction:i.a.func,onClose:i.a.func});var G=Object(l.d)("Common")(W),J=function(e){return!0===e.active},Q=Object(u.b)((function(e){var t=e.servers.servers.find(J);return{retrieveAuthHeaderFunction:function(){return s.a.DICOMWeb.getAuthorizationHeader(t)},url:t&&t.qidoRoot}}),null)(G),K=n(866);n(864);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?ne(e):t}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ae=function(e){function t(){var e,n;Z(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return oe(ne(n=ee(this,(e=te(t)).call.apply(e,[this].concat(a)))),"state",{search:""}),oe(ne(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.name,className:n.state.highlightedItem===e.name?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.name)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",{className:"project"},e.name.split("/")[7]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.stores,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"StoreList"},n.filter((function(e){return e.name.split("/")[7].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblStoreList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("DICOM Store")))),n&&c)}}])&&$(n.prototype,r),a&&$(n,a),t}(r.Component);oe(ae,"propTypes",{stores:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func}),oe(ae,"defaultProps",{loading:!0});var ie=Object(l.d)("Common")(ae);function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?de(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var be=function(e){function t(){var e,n;se(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return me(de(n=fe(this,(e=pe(t)).call.apply(e,[this].concat(o)))),"state",{error:null,loading:!0,stores:[],locations:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.a.setAccessToken(this.props.accessToken),e.next=3,K.a.loadDicomStores(this.props.dataset.name);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({stores:t.data.dicomStores||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){ue(o,n,r,a,c,"next",e)}function c(e){ue(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.stores,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{className:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(ie,{stores:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&le(n.prototype,r),a&&le(n,a),t}(r.Component);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function we(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?Oe(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}me(be,"propTypes",{dataset:i.a.object,onSelect:i.a.func,accessToken:i.a.string.isRequired});var Ee=function(e){function t(){var e,n;ve(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Pe(Oe(n=we(this,(e=Se(t)).call.apply(e,[this].concat(a)))),"state",{search:""}),Pe(Oe(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.name,className:n.state.highlightedItem===e.name?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.name)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",null,e.name.split("/")[5]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.datasets,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"DatasetList"},n.filter((function(e){return e.name.split("/")[5].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblDatasetList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Dataset")))),n&&c)}}])&&ge(n.prototype,r),a&&ge(n,a),t}(r.Component);Pe(Ee,"propTypes",{datasets:i.a.array,loading:i.a.bool,error:i.a.string,onSelect:i.a.func}),Pe(Ee,"defaultProps",{loading:!0});var ke=Object(l.d)("Common")(Ee);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?Te(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ne(e,t){return(Ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ae=function(e){function t(){var e,n;Ie(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Fe(Te(n=Re(this,(e=xe(t)).call.apply(e,[this].concat(o)))),"state",{error:null,loading:!0,datasets:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ne(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.a.setAccessToken(this.props.accessToken),e.next=3,K.a.loadDatasets(this.props.project.projectId,this.props.location.locationId);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({datasets:t.data.datasets||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Ce(o,n,r,a,c,"next",e)}function c(e){Ce(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.datasets,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{className:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(ke,{datasets:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&_e(n.prototype,r),a&&_e(n,a),t}(r.Component);function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t){return!t||"object"!==Le(t)&&"function"!=typeof t?He(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Fe(Ae,"propTypes",{project:i.a.object,location:i.a.object,onSelect:i.a.func,accessToken:i.a.string});var Ye=function(e){function t(){var e,n;Me(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Ve(He(n=Be(this,(e=qe(t)).call.apply(e,[this].concat(a)))),"state",{search:"",highlightedItem:null}),Ve(He(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.projectId,className:n.state.highlightedItem===e.projectId?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.projectId)},onClick:function(){n.onHighlightItem(e.projectId),n.props.onSelect(e)}},o.a.createElement("td",null,e.name),o.a.createElement("td",null,e.projectId))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.projects,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=r.toLowerCase(),u=n.filter((function(e){return"string"==typeof e.name&&(""===r||e.name.toLowerCase().includes(c))})),s=o.a.createElement("tbody",{id:"ProjectList"},u.map(this.renderTableRow));return o.a.createElement("table",{id:"tblProjectList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Project")),o.a.createElement("th",null,this.props.t("ID")))),n&&s)}}])&&Ue(n.prototype,r),a&&Ue(n,a),t}(r.Component);Ve(Ye,"propTypes",{projects:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func.isRequired,t:i.a.func}),Ve(Ye,"defaultProps",{loading:!0});var We=Object(l.d)("Common")(Ye);function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?$e(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt=function(e){function t(){var e,n;Qe(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return tt($e(n=Xe(this,(e=Ze(t)).call.apply(e,[this].concat(o)))),"state",{error:null,loading:!0,projects:[]}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.a.setAccessToken(this.props.accessToken),e.next=3,K.a.loadProjects();case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({projects:t.data.projects||[],filterStr:"",loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Je(o,n,r,a,c,"next",e)}function c(e){Je(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.projects,r=t.loading,a=t.filterStr,i=t.error,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{className:"form-control gcp-input",type:"text",value:a,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(We,{projects:n,loading:r,filter:a,error:i,onSelect:c}))}}])&&Ke(n.prototype,r),a&&Ke(n,a),t}(r.Component);function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function it(e,t){return!t||"object"!==rt(t)&&"function"!=typeof t?ut(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}tt(nt,"propTypes",{onSelect:i.a.func,accessToken:i.a.string});var ft=function(e){function t(){var e,n;ot(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return lt(ut(n=it(this,(e=ct(t)).call.apply(e,[this].concat(a)))),"state",{search:""}),lt(ut(n),"renderTableRow",(function(e){return o.a.createElement("tr",{key:e.locationId,className:n.state.highlightedItem===e.locationId?"noselect active":"noselect",onMouseEnter:function(){n.onHighlightItem(e.locationId)},onClick:function(){n.props.onSelect(e)}},o.a.createElement("td",null,e.name.split("/")[3]))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,e),n=t,(r=[{key:"onHighlightItem",value:function(e){this.setState({highlightedItem:e})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.locations,r=e.filter,a=e.error;if(a)return o.a.createElement("p",null,a);var i=o.a.createElement(f.i,{name:"circle-notch",className:"loading-icon-spin loading-icon"});if(t)return i;var c=o.a.createElement("tbody",{id:"LocationList"},n.filter((function(e){return e.name.split("/")[3].toLowerCase().includes(r.toLowerCase())||""==r})).map(this.renderTableRow));return o.a.createElement("table",{id:"tblLocationList",className:"gcp-table table noselect"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,this.props.t("Location")))),n&&c)}}])&&at(n.prototype,r),a&&at(n,a),t}(r.Component);lt(ft,"propTypes",{locations:i.a.array,loading:i.a.bool.isRequired,error:i.a.string,onSelect:i.a.func}),lt(ft,"defaultProps",{loading:!0});var pt=Object(l.d)("Common")(ft);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ht(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?gt(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ot=function(e){function t(){var e,n;mt(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return St(gt(n=ht(this,(e=vt(t)).call.apply(e,[this].concat(o)))),"state",{error:null,loading:!0,locations:[],filterStr:""}),n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.a.setAccessToken(this.props.accessToken),e.next=3,K.a.loadLocations(this.props.project.projectId);case 3:if(!(t=e.sent).isError){e.next=7;break}return this.setState({error:t.message}),e.abrupt("return");case 7:this.setState({locations:t.data.locations||[],loading:!1});case 8:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){yt(o,n,r,a,c,"next",e)}function c(e){yt(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.locations,r=t.loading,a=t.error,i=t.filterStr,c=this.props.onSelect;return o.a.createElement("div",null,o.a.createElement("input",{className:"form-control gcp-input",type:"text",value:i,onChange:function(t){return e.setState({filterStr:t.target.value})}}),o.a.createElement(pt,{locations:n,loading:r,error:a,filter:i,onSelect:c}))}}])&&bt(n.prototype,r),a&&bt(n,a),t}(r.Component);function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t){return!t||"object"!==jt(t)&&"function"!=typeof t?Ct(e):t}function Dt(e){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e,t){return(It=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}St(Ot,"propTypes",{project:i.a.object,onSelect:i.a.func,accessToken:i.a.string});var Rt=function(e){function t(){var e,n;Pt(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _t(Ct(n=kt(this,(e=Dt(t)).call.apply(e,[this].concat(o)))),"state",{project:null,location:null,dataset:null,unloading:!1}),_t(Ct(n),"onProjectSelect",(function(e){n.setState({project:e})})),_t(Ct(n),"onLocationSelect",(function(e){n.setState({location:e})})),_t(Ct(n),"onDatasetSelect",(function(e){n.setState({dataset:e})})),_t(Ct(n),"onProjectClick",(function(){n.setState({dataset:null,location:null,project:null})})),_t(Ct(n),"onLocationClick",(function(){n.setState({dataset:null,location:null})})),_t(Ct(n),"onDatasetClick",(function(){n.setState({dataset:null})})),_t(Ct(n),"onDicomStoreSelect",(function(e){var t=e.name,r=t.split("/"),o={wadoUriRoot:K.a.urlBase+"/".concat(t,"/dicomWeb"),qidoRoot:K.a.urlBase+"/".concat(t,"/dicomWeb"),wadoRoot:K.a.urlBase+"/".concat(t,"/dicomWeb"),project:r[1],location:r[3],dataset:r[5],dicomStore:r[7]};n.props.setServers(o)})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&It(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.user.access_token,t=this.state,n=t.project,r=t.location,a=t.dataset,i=this.onProjectClick,c=this.onLocationClick,u=this.onDatasetClick,s=this.onProjectSelect,l=this.onLocationSelect,f=this.onDatasetSelect,p=this.onDicomStoreSelect,d=o.a.createElement("div",{className:"gcp-picker--path"},o.a.createElement("span",null,this.props.t("Select a Project")));return n&&(d=o.a.createElement("div",{className:"gcp-picker--path"},o.a.createElement("span",{onClick:i},n.name),n&&r&&o.a.createElement("span",{onClick:c}," ","-> ",r.name.split("/")[3]),n&&r&&a&&o.a.createElement("span",{onClick:u}," ","-> ",a.name.split("/")[5]))),o.a.createElement(o.a.Fragment,null,d,!n&&o.a.createElement(nt,{accessToken:e,onSelect:s}),n&&!r&&o.a.createElement(Ot,{accessToken:e,project:n,onSelect:l}),n&&r&&!a&&o.a.createElement(Ae,{accessToken:e,project:n,location:r,onSelect:f}),n&&r&&a&&o.a.createElement(be,{accessToken:e,dataset:a,onSelect:p}))}}])&&Et(n.prototype,r),a&&Et(n,a),t}(r.Component);_t(Rt,"propTypes",{id:i.a.string,event:i.a.string,user:i.a.object,canClose:i.a.string,setServers:i.a.func.isRequired});var xt=Object(l.d)("Common")(Rt),Tt=n(879),Nt=n(196);function Ft(e){var t=e.isOpen,n=void 0!==t&&t,r=e.setServers,a=e.onClose,i=e.user,c=e.url,u=e.t,s=Nt.e.services.UIModalService;return o.a.createElement(o.a.Fragment,null,n&&void(s&&s.show({content:xt,title:u("Google Cloud Healthcare API"),contentProps:{setServers:function(e){var t=Tt.a(e,e.dicomstore);r(t),s.hide(),a()},user:i,url:c}})))}Ft.propTypes={isOpen:i.a.bool.isRequired,setServers:i.a.func.isRequired,onClose:i.a.func,user:i.a.object.isRequired,url:i.a.string};var At=Object(l.d)("Common")(Ft),Lt=function(e){return!0===e.active},Mt=Object(u.b)((function(e){var t=e.servers.servers.find(Lt);return{user:e.oidc&&e.oidc.user,url:t&&t.qidoRoot}}),(function(e){return{setServers:function(t){e({type:"SET_SERVERS",servers:t})}}}))(At),Ut=(n(903),n(199)),Bt=n(183),qt=n(103);function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vt(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Yt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Vt(a,r,o,i,c,"next",e)}function c(e){Vt(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Gt=s.a.utils.urlUtil;function Jt(e){var t=e.history,n=e.server,a=e.user,i=e.studyListFunctionsEnabled,c=Wt(Object(l.c)("Common"),1)[0],u=Wt(Object(r.useState)({fieldName:"PatientName",direction:"desc"}),2),s=u[0],y=u[1],m=Wt(Object(r.useState)({studyDateTo:null,studyDateFrom:null,PatientName:"",PatientID:"",AccessionNumber:"",StudyDate:"",modalities:"",StudyDescription:"",patientNameOrId:"",accessionOrModalityOrDescription:"",allFields:""}),2),b=m[0],h=m[1],v=Wt(Object(r.useState)([]),2),g=v[0],w=v[1],S=Wt(Object(r.useState)({isSearchingForStudies:!1,error:null}),2),O=S[0],j=S[1],P=Wt(Object(r.useState)(null),2),E=P[0],k=P[1],D=Wt(Object(r.useState)(25),2),C=D[0],I=D[1],_=Wt(Object(r.useState)(0),2),R=_[0],x=_[1],T=Object(r.useContext)(qt.a),N=Object(f.J)(["(min-width: 1750px)","(min-width: 1000px) and (max-width: 1749px)","(max-width: 999px)"],["large","medium","small"],"small"),F=Object(f.I)(s,200),A=Object(f.I)(b,250),L=T.appConfig,M=void 0===L?{}:L;!n&&M.enableGoogleCloudAdapter&&"DicomStorePicker"!==E&&k("DicomStorePicker"),Object(r.useEffect)((function(){n&&function(){var e=Yt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j({error:null,isSearchingForStudies:!0}),e.next=4,Qt(n,A,F,C,R,N);case 4:t=e.sent,w(t),j({error:null,isSearchingForStudies:!1}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn(e.t0),j({error:!0,isFetching:!1});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}()()}),[A,F,C,R,N,n]);if(O.error)return o.a.createElement("div",null,"Error: ",JSON.stringify(O.error));if(g===[]&&!E)return o.a.createElement("div",null,"Loading...");var U=null,B=null;M.enableGoogleCloudAdapter&&(!function(e,t,n,r){if(e)return;var o=d.b(t,n);if(Gt.paramString.isValidPath(o)){var a=r.location;(void 0===a?{}:a).pathname!==o&&r.replace(o)}}("DicomStorePicker"===E,M,n,t),B=o.a.createElement(Mt,{isOpen:"DicomStorePicker"===E,onClose:function(){return k(null)}}),U=o.a.createElement("div",{className:"form-inline btn-group pull-right",style:{padding:"20px"}},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){return k("DicomStorePicker")}},c("Change DICOM Store"))));return o.a.createElement(o.a.Fragment,null,i?o.a.createElement(Q,{isOpen:"DicomFilesUploader"===E,onClose:function(){return k(null)}}):null,B,o.a.createElement(Bt.a.Consumer,null,(function(e){return o.a.createElement(Ut.a.Consumer,null,(function(t){return o.a.createElement(p.a,{home:!0,user:a,userManager:t},e.logoComponent)}))})),o.a.createElement("div",{className:"study-list-header"},o.a.createElement("div",{className:"header"},o.a.createElement("h1",{style:{fontWeight:300,fontSize:"22px"}},c("StudyList"))),o.a.createElement("div",{className:"actions"},i&&U,i&&o.a.createElement(f.p,{onImport:function(){return k("DicomFilesUploader")}}),o.a.createElement("span",{className:"study-count"},g.length))),o.a.createElement("div",{className:"table-head-background"}),o.a.createElement("div",{className:"study-list-container"},o.a.createElement(f.y,{isLoading:O.isSearchingForStudies,hasError:!0===O.error,studies:g,onSelectItem:function(e){var r=d.c(M,n,{studyInstanceUIDs:e});t.push(r)},sort:s,onSort:function(e){var t=e,n="asc";e===s.fieldName&&("asc"===s.direction?n="desc":(t=null,n=null)),y({fieldName:t,direction:n})},filterValues:b,onFilterChange:function(e,t){h((function(n){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n,zt({},e,t))}))},studyListDateFilterNumDays:M.studyListDateFilterNumDays,displaySize:N}),o.a.createElement(f.D,{currentPage:R,nextPageFunc:function(){return x(R+1)},prevPageFunc:function(){return x(R-1)},onRowsPerPageChange:function(e){return I(e)},rowsPerPage:C,recordCount:g.length})))}function Qt(e,t,n,r,o,a){return Kt.apply(this,arguments)}function Kt(){return(Kt=Yt(regeneratorRuntime.mark((function e(t,n,r,o,a,i){var c,u,s,l,f,p,d,y,b,h,v,g,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.allFields,u=n.patientNameOrId,s=n.accessionOrModalityOrDescription,l=r.fieldName||"PatientName",f=r.direction||"desc",p=n.studyDateFrom||m()().subtract(25e3,"days").toDate(),d=n.studyDateTo||new Date,y={PatientID:n.PatientID,PatientName:n.PatientName,AccessionNumber:n.AccessionNumber,StudyDescription:n.StudyDescription,ModalitiesInStudy:n.modalities,studyDateFrom:p,studyDateTo:d,limit:o,offset:a*o,fuzzymatching:!0===t.supportsFuzzyMatching},e.next=8,Zt(t,y,i,{allFields:c,patientNameOrId:u,accessionOrModalityOrDescription:s});case 8:return b=e.sent,h=b.map((function(e){var t="string"==typeof e.PatientName?e.PatientName:void 0;return{AccessionNumber:e.AccessionNumber,modalities:e.modalities,PatientID:e.PatientID,PatientName:t,StudyDate:e.StudyDate,StudyDescription:e.StudyDescription,StudyInstanceUID:e.StudyInstanceUID}})),v=Xt(h,{allFields:"PatientName",patientNameOrId:"PatientName",accessionOrModalityOrDescription:"modalities"}[l]||l,f),g=v.length<o?v.length:o,w=v.slice(0,g),e.abrupt("return",w);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xt(e,t,n){var r=e.map((function(e){return m()(e.StudyDate,"MMM DD, YYYY",!0).isValid()||(e.StudyDate=m()(e.StudyDate,"YYYYMMDD").format("MMM DD, YYYY")),e}));return r.sort((function(e,r){var o=e[t],a=r[t];return"StudyDate"===t&&(o=m()(o).toISOString(),a=m()(a).toISOString()),"desc"===n?o<a?-1:o>a?1:0:o>a?-1:o<a?1:0})),r}function Zt(e,t,n,r){return $t.apply(this,arguments)}function $t(){return($t=Yt(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,c,u,l,f,p,d,y,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.allFields,i=o.patientNameOrId,c=o.accessionOrModalityOrDescription,u=[n],"small"===r?(l=en(n,["PatientID","PatientName","AccessionNumber","StudyDescription","ModalitiesInStudy"],a)).length&&(u=l):"medium"===r&&(f=en(n,["PatientID","PatientName"],i),p=en(n,["AccessionNumber","StudyDescription","ModalitiesInStudy"],c),(f.length||p.length)&&(u=f.concat(p))),d=[],u.forEach((function(e){var n=s.a.studies.searchStudies(t,e);d.push(n)})),e.next=7,Promise.all(d);case 7:return y=e.sent,m=[],y.forEach((function(e){e&&e.forEach((function(e){m.some((function(t){return t.StudyInstanceUID===e.StudyInstanceUID}))||m.push(e)}))})),e.abrupt("return",m);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function en(e,t,n){var r=[];return""!==n&&n?(t.forEach((function(t){var o=Object.assign({PatientID:"",PatientName:"",AccessionNumber:"",StudyDescription:"",ModalitiesInStudy:""},e);o[t]=n,r.push(o)})),r):r}Jt.propTypes={filters:i.a.object,PatientID:i.a.string,server:i.a.object,user:i.a.object,history:i.a.object,studyListFunctionsEnabled:i.a.bool},Jt.defaultProps={studyListFunctionsEnabled:!0};var tn=Object(c.f)(Jt),nn=function(e){return!0===e.active},rn=Object(u.b)((function(e){return{server:e.servers.servers.find(nn),user:e.oidc.user}}),null)(tn),on=n(888),an=s.a.utils.urlUtil;function cn(e){var t=e.match,n=e.location,a=t.params,i=a.project,c=a.location,u=a.dataset,s=a.dicomStore,l=(a.studyInstanceUIDs,a.seriesInstanceUIDs,Object(on.a)({project:i,location:c,dataset:u,dicomStore:s}),Object(r.useContext)(qt.a).appConfig),f=void 0===l?{}:l,p=an.queryString.getQueryFilters(n),d=!1;return f.studyListFunctionsEnabled&&(d=f.studyListFunctionsEnabled),o.a.createElement(rn,{filters:p,studyListFunctionsEnabled:d})}cn.propTypes={location:i.a.shape({search:i.a.string}).isRequired};t.default=Object(c.f)(cn)},864:function(e,t,n){},865:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);function o(e){var t=Object(r.useRef)();return Object(r.useEffect)((function(){t.current=e}),[e]),t.current}},866:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function c(e){i(a,r,o,c,u,"next",e)}function u(e){i(a,r,o,c,u,"throw",e)}c(void 0)}))}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,a,i,s,l,f;return t=e,(n=[{key:"setAccessToken",value:function(e){e||console.error("Access token is empty"),this.accessToken=e}},{key:"getUrlBaseDicomWeb",value:function(e,t,n,r){return this.urlBase+"/projects/".concat(e,"/locations/").concat(t,"/datasets/").concat(n,"/dicomStores/").concat(r,"/dicomWeb")}},{key:"getUrlPath",value:function(e,t,n,r){"/projects/".concat(e,"/locations/").concat(t,"/datasets/").concat(n,"/dicomStores/").concat(r)}},{key:"doRequest",value:(f=c(regeneratorRuntime.mark((function e(t){var n,r,a,i,c,u,s,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},r=l.length>2&&void 0!==l[2]?l[2]:{},a=new URL(t),i=null,a.search=new URLSearchParams(r),e.prev=5,e.next=8,fetch(a,o({},this.fetchConfig,{config:n}));case 8:return c=e.sent,e.prev=9,e.next=12,c.json();case 12:i=e.sent,e.next=17;break;case 15:e.prev=15,e.t0=e.catch(9);case 17:if(!(c.status>=200&&c.status<300&&null!=i)){e.next=27;break}if(null==i.nextPageToken){e.next=24;break}return r.pageToken=i.nextPageToken,e.next=22,this.doRequest(t,n,r);case 22:for(s in u=e.sent,i)i.hasOwnProperty(s)&&(i[s]=i[s].concat(u.data[s]));case 24:return e.abrupt("return",{isError:!1,status:c.status,data:i});case 27:return e.abrupt("return",{isError:!0,status:c.status,message:i&&i.error&&i.error.message||"Unknown error"});case 28:e.next=35;break;case 30:if(e.prev=30,e.t1=e.catch(5),!i||!i.error){e.next=34;break}return e.abrupt("return",{isError:!0,status:e.t1.status,message:e.t1.response.data.error.message||"Unspecified error"});case 34:return e.abrupt("return",{isError:!0,message:e.t1&&e.t1.message||"Oops! Something went wrong"});case 35:case"end":return e.stop()}}),e,this,[[5,30],[9,15]])}))),function(e){return f.apply(this,arguments)})},{key:"loadProjects",value:(l=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("https://cloudresourcemanager.googleapis.com/v1/projects"));case 1:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"loadLocations",value:(s=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBaseProject,"/").concat(t,"/locations")));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"loadDatasets",value:(i=c(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBaseProject,"/").concat(t,"/locations/").concat(n,"/datasets")));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"loadDicomStores",value:(a=c(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.doRequest("".concat(this.urlBase,"/").concat(t,"/dicomStores")));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"fetchConfig",get:function(){if(!this.accessToken)throw new Error("OIDC access_token is not set");return{method:"GET",headers:{Authorization:"Bearer "+this.accessToken}}}},{key:"urlBase",get:function(){return this.healthcareApiEndpoint||"https://healthcare.googleapis.com/v1beta1"},set:function(e){this.healthcareApiEndpoint=e}},{key:"urlBaseProject",get:function(){return this.urlBase+"/projects"}}])&&u(t.prototype,n),r&&u(t,r),e}();t.a=new s},879:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r=function(e,t){var n=e.wadoUriRoot,r=e.qidoRoot,o=e.wadoRoot,a=e.dataset,i=void 0===a?"":a,c=e.dicomStore,u=void 0===c?"":c,s=e.location,l=void 0===s?"":s,f=e.project;return[{name:t,dataset:i,dicomStore:u,location:l,project:void 0===f?"":f,imageRendering:"wadors",thumbnailRendering:"wadors",type:"dicomWeb",active:!0,wadoUriRoot:n,qidoRoot:r,wadoRoot:o,supportsFuzzyMatching:!1,qidoSupportsIncludeField:!1}]},o=function(e){return e&&!!e.dataset&&!!e.dicomStore&&!!e.location&&!!e.project},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.keys(e).length,r=Object.keys(t).length;return!(!n||!r)&&(e.dataset===t.dataset&&e.dataset===t.dataset&&e.dicomStore===t.dicomStore&&e.location===t.location&&e.project===t.project)}},888:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n(0),o=n(866),a=n(865),i=n(879),c=n(58),u=(n(174),n(103)),s=function(e){return e&&e.servers&&e.servers.find((function(e){return!0===e.active}))},l=function(e,t,n,r,a){var c=[];if(e.enableGoogleCloudAdapter){o.a.urlBase=e.healthcareApiEndpoint;var u=o.a.getUrlBaseDicomWeb(t,n,r,a),s={project:t,location:n,dataset:r,dicomStore:a,wadoUriRoot:u,qidoRoot:u,wadoRoot:u};if(c=i.a(s,a),!f(c[0],e))return}return c},f=function(e,t){return t.enableGoogleCloudAdapter?i.c(e):!!e},p=function(e,t){e({type:"SET_SERVERS",servers:t})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;arguments.length>5&&arguments[5],arguments.length>6&&arguments[6],arguments.length>7&&arguments[7],arguments.length>8&&arguments[8];if(!o.enableGoogleCloudAdapter)return!1;var a=t!==e&&t;if(a)return!1;if(!r||!r.length)return!1;if(!e.length||!n)return!0;var c=r[0],u=e.some(i.b.bind(void 0,c));return!u};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.project,n=e.location,o=e.dataset,i=e.dicomStore,y=Object(c.d)((function(e){return e&&e.servers})),m=Object(a.a)(y),b=Object(c.c)(),h=Object(r.useContext)(u.a),v=h.appConfig,g=void 0===v?{}:v,w=s(y),S=l(g,t,n,o,i)||[],O=d(y.servers,m,w,S,g,t,n,o,i);if(O)p(b,S);else if(f(w,g))return w}},903:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return q}));var o=function(){function e(){var t,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(n="fileType")in(t=this)?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}var t,n,o;return t=e,(n=[{key:"loadFile",value:function(e,t){}},{key:"getDataset",value:function(e,t){}},{key:"getStudies",value:function(e,t){}}])&&r(t.prototype,n),o&&r(t,o),e}(),a=n(131);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?p(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=new(function(e){function t(){var e,n;u(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return y(p(n=l(this,(e=f(t)).call.apply(e,[this].concat(o)))),"fileType","application/pdf"),n}var n,r,o,i,m;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:(i=regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)();case 2:return r=e.sent,e.abrupt("return",r.wadouri.loadFileRequest(n));case 4:case"end":return e.stop()}}),e)})),m=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){c(o,n,r,a,u,"next",e)}function u(e){c(o,n,r,a,u,"throw",e)}a(void 0)}))},function(e,t){return m.apply(this,arguments)})},{key:"getDataset",value:function(e,t){var n={};return n.imageId=e.imageId||t,n}},{key:"getStudies",value:function(e,t){return this.getDefaultStudy(t)}},{key:"getDefaultStudy",value:function(e){return{StudyInstanceUID:"",StudyDate:"",StudyTime:"",AccessionNumber:"",ReferringPhysicianName:"",PatientName:"",PatientID:"",PatientBirthdate:"",PatientSex:"",StudyId:"",StudyDescription:"",series:[{SeriesInstanceUID:"",SeriesDescription:"",SeriesNumber:"",instances:[{metadata:{SOPInstanceUID:"",SOPClassUID:"1.2.840.10008.5.1.4.1.1.104.1",Rows:"",Columns:"",NumberOfFrames:0,InstanceNumber:1},getImageId:function(){return e},isLocalFile:!0}]}]}}}])&&s(n.prototype,r),o&&s(n,o),t}(o)),b=n(36);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?j(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=n(14).a.cornerstone.metadataProvider,D=new(function(e){function t(){var e,n;g(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return E(j(n=S(this,(e=O(t)).call.apply(e,[this].concat(o)))),"fileType","application/dicom"),n}var n,r,o,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,e),n=t,(r=[{key:"loadFile",value:(i=regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)();case 2:return r=e.sent,e.abrupt("return",r.wadouri.loadFileRequest(n));case 4:case"end":return e.stop()}}),e)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){v(o,n,r,a,c,"next",e)}function c(e){v(o,n,r,a,c,"throw",e)}a(void 0)}))},function(e,t){return c.apply(this,arguments)})},{key:"getDataset",value:function(e,t){var n={};try{var r=b.b.DicomMessage.readFile(e);n=b.b.DicomMetaDictionary.naturalizeDataset(r.dict),k.addInstance(n),n._meta=b.b.DicomMetaDictionary.namifyDataset(r.meta)}catch(e){console.error("Error reading dicom file",e)}return n.imageId=t,n}},{key:"getStudies",value:function(e,t){return this.getStudyFromDataset(e)}},{key:"getStudyFromDataset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.StudyInstanceUID,n=e.StudyDate,r=e.StudyTime,o=e.AccessionNumber,a=e.ReferringPhysicianName,i=e.PatientName,c=e.PatientID,u=e.PatientBirthDate,s=e.PatientSex,l=e.StudyID,f=e.StudyDescription,p=e.SeriesInstanceUID,d=e.SeriesDescription,y=e.SeriesNumber,m=e.imageId,b={metadata:e,url:m},h={SeriesInstanceUID:p,SeriesDescription:d,SeriesNumber:y,instances:[b]},v={StudyInstanceUID:t,StudyDate:n,StudyTime:r,AccessionNumber:o,ReferringPhysicianName:a,PatientName:i,PatientID:c,PatientBirthDate:u,PatientSex:s,StudyID:l,StudyDescription:f,series:[h]};return v}}])&&w(n.prototype,r),o&&w(n,o),t}(o));function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(o=T(t).call(this))||"object"!==C(o)&&"function"!=typeof o?N(r):o,A(N(n),"fileType",void 0),A(N(n),"loader",void 0);var a=e&&e.type;return n.loader=n.getLoader(a),n.fileType=n.loader.fileType,n}var n,r,o,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,e),n=t,r=[{key:"addFile",value:(i=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)();case 2:return n=e.sent,e.abrupt("return",n.wadouri.fileManager.add(t));case 4:case"end":return e.stop()}}),e)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){R(o,n,r,a,c,"next",e)}function c(e){R(o,n,r,a,c,"throw",e)}a(void 0)}))},function(e){return c.apply(this,arguments)})},{key:"loadFile",value:function(e,t){return this.loader.loadFile(e,t)}},{key:"getDataset",value:function(e,t){return this.loader.getDataset(e,t)}},{key:"getStudies",value:function(e,t){return this.loader.getStudies(e,t)}},{key:"getLoader",value:function(e){return"application/pdf"===e?m:D}}],o=[{key:"groupSeries",value:function(e){var t=function(e,t,n){var r=1;return e.reduce((function(e,o){var a,i=o[t],c=o[n];return e[i=i||""+r++]||(e[i]=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},o),e[i][n]=[]),(a=e[i][n]).push.apply(a,I(c)),e}),{})};return Object.values(t(e,"StudyInstanceUID","series")).map((function(e){var n=t(e.series,"SeriesInstanceUID","instances");return e.series=Object.values(n),e}))}}],r&&x(n.prototype,r),o&&x(n,o),t}(o);function M(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){M(a,r,o,i,c,"next",e)}function c(e){M(a,r,o,i,c,"throw",e)}i(void 0)}))}}var B=function(){var e=U(regeneratorRuntime.mark((function e(t){var n,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new L(t),e.next=4,n.addFile(t);case 4:return r=e.sent,e.next=7,n.loadFile(t,r);case 7:return o=e.sent,e.next=10,n.getDataset(o,r);case 10:return a=e.sent,e.next=13,n.getStudies(a,r);case 13:return i=e.sent,e.abrupt("return",i);case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0.name,":Error when trying to load and process local files:",e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}();function q(e){return H.apply(this,arguments)}function H(){return(H=U(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(B),e.next=3,Promise.all(n);case 3:return r=e.sent,e.abrupt("return",L.groupSeries(r.flat()));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},956:function(e,t,n){}}]);
//# sourceMappingURL=StudyListRouting.bundle.79a23b609bf4b9daee45.js.map